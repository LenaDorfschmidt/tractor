<!DOCTYPE html>

<html lang="en">

<head>
  <title>TractoR ~ Connectivity graphs</title>

  <meta charset="utf-8" />
  <meta name="author" content="Jon Clayden" />
  <link rel="stylesheet" href="style.css" />
  
  <script type="text/javascript" src="hyphenator.js"></script>
  
  <script type="text/javascript" src="http://use.typekit.com/hqw1phx.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-563735-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</head>

<body>

<div id="main" class="hyphenate">

<table id="tabs">
  <tr>
  <td class="tab"><a href="home.html">Home</a></td>
  <td class="tab"><a href="home.html#site-contents">Contents</a></td>
  <td class="tab"><a href="downloads.html">Downloads</a></td>
  <td class="tab"><a href="changelog.html">Changelog</a></td>
  <td class="tab"><a href="references.html">References</a></td>
  <td class="tab"><a href="https://www.jiscmail.ac.uk/cgi-bin/webadmin?A0=TRACTOR">Mailing list</a></td>
  </tr>
</table>


<h1>Connectivity graphs</h1>

<p>This page discusses TractoR&rsquo;s facilities for creating, manipulating and visualising abstract graphs representing brain connectivity. Some <a href="structural.html">parcellated structural data</a> is a prerequisite.</p>

<h2 id="creating-a-graph-diffusion">Creating a graph (diffusion)</h2>

<p>Using <a href="diffusion-processing.html">diffusion-weighted data</a> and tractography, a graph can be created which represents streamline-based connectivity between regions of interest. The general principle is to seed within regions of interest, or across the whole brain; identify sets of streamlines which connect pairs of anatomical regions; and then (optionally) to use properties of these streamlines to derive a quantitative measure of region-to-region connectivity. In TractoR, these three tasks would usually be performed by the <code>xtrack</code> (or <code>mtrack</code>), <code>graph-build</code> and <code>graph-reweight</code> scripts.</p>

<p>To generate a set of streamlines, each of which passes through at least one target region of interest, we can use the <code>xtrack</code> script. For example,</p>

<pre><code>tractor xtrack /data/subject1 AnisotropyThreshold:0.2 JitterSeeds:true TractName:all
</code></pre>

<p>In this case we seed from every voxel within the brain mask that has an anisotropy of at least 0.2, jittering seed locations randomly to move them off the regular voxel grid. By default the target regions are all areas identified as cerebral cortex in the <a href="structural.html">parcellation lookup table</a>. Other targets, such as subcortical grey matter, can also be included using a command like</p>

<pre><code>tractor xtrack /data/subject1 AnisotropyThreshold:0.2 JitterSeeds:true TractName:all TargetRegions:cerebral_cortex,deep_grey_matter
</code></pre>

<p>A set of streamlines is generated by this script and written into the file &ldquo;all_streamlines.Rdata&rdquo;. These can then be used to create a graph using a command like</p>

<pre><code>tractor graph-build /data/subject1 TractName:all TargetRegions:cerebral_cortex,deep_grey_matter GraphName:diffusion_graph
</code></pre>

<p>The <code>TargetRegions</code> and <code>TractName</code> options should match what were used for <code>xtrack</code>, and you may want to create a <a href="HNT-tutorial.html#using-a-design-file">design file</a> for convenience.</p>

<p>At this point you have a binary graph in which an edge exists between each pair of regions connected by at least one streamline. Each edge has attributes like the average voxelwise FA along the streamlines or the number of streamlines constituting the connection, and vertices have attributes such as their volume. These can be used to assign weights to the edges if required. For example,</p>

<pre><code>tractor graph-reweight nStreamlines GraphName:diffusion_graph
</code></pre>

<p>will use the number of streamlines as the weight of the connection. Vertex attributes can also be used, but since there are two such values for each connection, you need to decide how to merge them. For example,</p>

<pre><code>tractor graph-reweight &quot;nStreamlines/voxelCount&quot; VertexAttributes:mean GraphName:diffusion_graph
</code></pre>

<p>will average the two vertex attributes for each edge, and then use the number of streamlines divided by the average voxel count in the two target regions as the weight.</p>

<h2 id="graph-properties">Graph properties</h2>

<p>The basic properties of a graph object can be obtained using the generic <code>peek</code> script, viz.</p>

<pre><code>tractor peek graph.Rdata
</code></pre>

<p>However additional graph-theoretical metrics can be calculated and displayed using the <code>graph-props</code> script:</p>

<pre><code>tractor graph-props graph.Rdata
</code></pre>

<p>Please note that the latter script requires the optional <code>igraph</code> package to be installed.</p>

<h2 id="graph-visualisation">Graph visualisation</h2>

<p>The <code>graph-viz</code> script can be used to visualise graphs, either as an association matrix or in traditional topological form.</p>

<pre><code>tractor graph-viz GraphName:graph MatrixView:true WeightLimits:0,0.1
</code></pre>

<p><img src="graph-matrix.png" alt="Graph shown as association matrix"></p>

<pre><code>tractor graph-viz GraphName:graph MatrixView:false UseLocations:true ShowBrain:true WeightLimits:0,0.1
</code></pre>

<p><img src="graph-brain.png" alt="Graph shown topologically on brain"></p>

<h2 id="graph-decomposition">Graph decomposition</h2>

<p>For many applications you may be interested subnetworks within the overall brain graph, rather than the entire graph as a whole. You could determine these subnetworks by hand, but TractoR also provides some data-driven approaches to factoring or partitioning a graph into parts. The techniques currently offered are <a href="http://dx.doi.org/10.1371/journal.pone.0060997">principal network analysis</a> and a <a href="http://dx.doi.org/10.1073/pnas.0601602103">modularity maximisation</a> partitioning algorithm. Both of these are accessible through the <code>graph-decompose</code> script. For example,</p>

<pre><code>tractor graph-decompose GraphName:graph Method:principal-networks EdgeWeightThreshold:0.2
</code></pre>

<p>The principal networks approach uses a matrix factoring approach akin to principal component analysis, while modularity maximisation tries to separate the graph. These and other approaches to graph decomposition, their strengths and weaknesses, are discussed in the <a href="http://dx.doi.org/10.1371/journal.pone.0060997">principal networks paper</a>. Either way, the result is a file called &ldquo;graph_decomposed.Rdata&rdquo;, which contains a series of smaller graphs. This file can be split into its parts using the <code>split</code> script, viz.</p>

<pre><code>tractor split graph_decomposed.Rdata
</code></pre>

<p>The individual graphs can then be visualised, or their graph properties calculated, as needed.</p>


</div>

</body>

</html>
