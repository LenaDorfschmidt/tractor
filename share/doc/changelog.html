<!DOCTYPE html>

<html lang="en">

<head>
  <title>TractoR ~ Changelog</title>

  <meta charset="utf-8" />
  <meta name="author" content="Jon Clayden" />
  <link rel="stylesheet" href="style.css" />
  
  <script type="text/javascript" src="hyphenator.js"></script>
  
  <script type="text/javascript" src="http://use.typekit.com/hqw1phx.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-563735-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</head>

<body>

<div id="main" class="hyphenate">

<table id="tabs">
  <tr>
  <td class="tab"><a href="home.html">Home</a></td>
  <td class="tab"><a href="home.html#site-contents">Contents</a></td>
  <td class="tab"><a href="downloads.html">Downloads</a></td>
  <td class="tab"><a href="changelog.html">Changelog</a></td>
  <td class="tab"><a href="references.html">References</a></td>
  <td class="tab"><a href="http://groups.google.com/group/tractor-users">Mailing list</a></td>
  </tr>
</table>


<h1>Changelog</h1>

<p>The significant user-visible changes in each release of TractoR are documented below.</p>

<h2 id="231-2013-02-12">2.3.1 (2013-02-12)</h2>

<ul>
<li>The tests should no longer fail after a clean install of the package.</li>
</ul>

<h2 id="230-2013-02-04">2.3.0 (2013-02-04)</h2>

<ul>
<li>TractoR now includes a simple interactive image viewer, which is used by default unless the <code>TRACTOR_VIEWER</code> environment variable is set to <code>fslview</code> (for FSLview, as in earlier releases) or <code>freeview</code> (to use FreeSurfer&#39;s FreeView, for which a new interface has also been added). The new TractoR viewer remains work in progress, and FSLview is still favoured by scripts for showing 4D or vector-valued images.</li>
<li>The <code>dicomsort</code> script&#39;s <code>SortBySubjectFirst</code> option has been replaced by a more general <code>SortOn</code> option, which allows the files to be sorted by series, subject and/or date in any order. The script is also more careful to avoid deleting files which are not moved because they are already in the right place.</li>
<li>The <code>mtrack</code> script now allows the user to specify &ldquo;termination&rdquo; masks, which cause truncation of streamlines. It is possible to specify a single mask as both a waypoint and a termination mask. Likewise, <code>ptrack</code> gains a <code>TerminateAtTarget</code> option.</li>
<li>TractoR&#39;s internal tractography algorithm is now the default for <code>rtrack</code> and <code>mtrack</code>.</li>
<li>If the <code>gradrotate</code> script is applied to a session, the original (unrotated) gradient directions are first copied to the file <code>tractor/diffusion/directions-orig.txt</code>. This makes it much easier to tell whether rotation has been performed, and is used by the code to make sure that the gradients are not rotated twice.</li>
<li>The <code>gmap</code> script gains a <code>UseReferencePlanes</code> option: if it is &ldquo;false&rdquo; then the plane of the maximum in the image is used for visualisation. In addition, the script should no longer produce an error when the reference seed point is not in the centre of a voxel.</li>
<li>The <code>dirviz</code> script gains a <code>ScaleFactor</code> option to control the size of the PNG image produced.</li>
<li>The <code>pnt-data-sge</code> script now captures SGE/OGE job numbers more robustly, thereby avoiding spurious errors.</li>
<li>PNT reference tracts (including those provided with TractoR) should now have smaller file sizes.</li>
<li>Code which reads from DICOM files should no longer produce an error while checking if a very small file is a DICOM file or not, or when handling oblique images.</li>
<li>The PNT reference tract test has been tweaked to avoid spurious failures.</li>
<li>Using the FSL tracker with FSL versions containing more than three parts (e.g. 5.0.2.1) no longer fails.</li>
</ul>

<h2 id="221-2012-08-29">2.2.1 (2012-08-29)</h2>

<ul>
<li>The <code>pnt-prune</code> script would sometimes misinterpret the median streamline which is used as a baseline, resulting in a far less tightly pruned final tract than expected for some data sets. This has now been corrected.</li>
</ul>

<h2 id="220-2012-08-17">2.2.0 (2012-08-17)</h2>

<ul>
<li>TractoR now has the ability to perform kernel-based image processing operations. The new <code>smooth</code> and <code>morph</code> scripts can be used to smooth an image, or to apply a mathematical morphology operation such as erosion or dilation.</li>
<li>The masking stage of the <code>dpreproc</code> script (with <code>MaskingMethod:kmeans</code> only) now uses a morphological closing operation to remove small &ldquo;holes&rdquo; in the segmentation.</li>
<li>The new <code>ptrack</code> script can be used to perform connectivity &ldquo;profiling&rdquo;, generating a table of streamline counts connecting each voxel in a seed region to each of a set of target regions.</li>
<li>The <code>mtrack</code> script now supports the use of so-called &ldquo;exclusion masks&rdquo; (using the internal tracker only). Streamlines passing through any such exclusion region will be removed from the result.</li>
<li>The <code>track</code> and <code>mtrack</code> scripts now allow the set of streamlines that they generate to be stored in a binary file. This may be converted to the format used by <a href="http://www.trackvis.org">TrackVis</a> for visualisation using the new <code>streamlines2trk</code> script.</li>
<li>The new <code>imagestats</code> script can be used to obtain a series of statistics about part or all of an image, such as volume, intensity range and mean intensity.</li>
<li>Experimental support for auto-updating a TractoR installation has been added, via the new <code>update</code> script. This attempts to check the project web site for new versions of the package. See <code>tractor -o update</code> for usage.</li>
<li>The newly-added <code>upgrade</code> script can be used to convert objects stored in &ldquo;.Rdata&rdquo; files from TractoR 1.x formats to their TractoR 2.x equivalents.</li>
<li>The code underlying the <code>dicomread</code> script has been substantially reworked to improve speed (in some cases substantially) and reliability in determining the orientation of the data. The script also gains an option to inhibit the untiling of DICOM files which appear to use the Siemens &ldquo;mosaic&rdquo; format.</li>
<li>The <code>view</code> script no longer requires the user to press Enter to quit, and does not spend time converting images to Analyze format when not necessary.</li>
<li>Substantial additions to the package&#39;s support for sparse images have been made, and the <code>values</code> script now takes advantage of these.</li>
<li>The <code>TRACTOR_HOME</code> environment variable is now guessed if it is not set, although routine reliance on this mechanism is not advised.</li>
<li>Support for scripts in <code>/etc/tractor</code> has been removed. These have been deprecated since TractoR 1.0.0.</li>
<li>Interrelationships between the various TractoR packages have now been more explicitly declared. This may avoid occasional problems when using them within R.</li>
<li>Marginally invalid quaternion parameters in NIfTI headers are now handled more gracefully.</li>
</ul>

<h2 id="212-2012-05-03">2.1.2 (2012-05-03)</h2>

<ul>
<li>The <code>dpreproc</code> script now warns if the <em>diffusion subdirectory</em> already exists within the session, rather than just if the session&#39;s root directory exists.</li>
<li>Spurious errors, about images not having been created yet, should no longer occur when TractoR updates the structure of a session directory created with version 1.x.</li>
<li>An issue with installing the &ldquo;tractor.native&rdquo; package on some Linux systems has been addressed. The package&#39;s &ldquo;configure&rdquo; process has been somewhat simplified at the same time. (Reported by Mark Bastin.)</li>
</ul>

<h2 id="211-2012-03-23">2.1.1 (2012-03-23)</h2>

<ul>
<li>A significant memory leak has been corrected in the new tracking code, which resulted in scripts which run lots of tractography (such as <code>pnt-data</code>) using very large amounts of memory.</li>
<li>The <code>mtrack</code> script allows multiple waypoint masks to be specified from the command line, comma separated, in line with the syntax used in various other scripts. The <code>ShowSeedPoint</code> option is ignored when no seed mask is specified (i.e. when the seed region is the whole brain).</li>
<li>The <code>mtrack</code> script with <code>Tracker:tractor</code> no longer produces an error if no streamlines pass through all of the waypoints.</li>
<li>Occasional spurious errors, saying that &ldquo;all seed points must be the same&rdquo;, should no longer be generated by the <code>pnt-data</code> script. (Reported by Clare Gibbard.)</li>
<li>The <code>dicomread</code> script now correctly uses the TR as the fourth voxel dimension when individual files represent slices, rather than volumes.</li>
<li>The HTML documentation has been updated to match the latest version of the TractoR web site. (This will be standard practice in future releases.)</li>
</ul>

<h2 id="210-2012-03-09">2.1.0 (2012-03-09)</h2>

<ul>
<li>The internal tracking code has been substantially reworked, and can now be used in the <code>rtrack</code> and <code>mtrack</code> scripts. (Results should, however, be comparable with previous versions.) The <code>mtrack</code> script can now also be used to perform whole-brain tractography.</li>
<li>TractoR now properly handles temporal units in NIfTI files. The <code>dicomread</code> script will set the temporal resolution of a 4D image series to the repetition time (TR) stored in the DICOM metadata. (The voxel dimension for dimensions above three was previously fixed to 1, so this will result in some differences in output.)</li>
<li>A full set of HTML-based documentation is now included in the TractoR distribution, and can be found at <code>share/doc/home.html</code>.</li>
<li>HNT and PNT reference tracts for the ventral cingulum and inferior longitudinal fasciculus have been added.</li>
<li>A top-level session directory map can now be used to redefine the location of subdirectories within the TractoR hierarchy. This mechanism can also be used to allow sessions to share some data. All session maps are now also cached internally.</li>
<li>TractoR now tries harder to work with images stored in a rotated coordinate system (although warnings will be generated).</li>
<li>The number of clusters used by the k-means algorithm in <code>dpreproc</code> can now be set using the new <code>KMeansClusters</code> option. This option can be refined interactively, or the user can switch to using BET if required.</li>
<li>TractoR can now read only selected volumes from an image file. The <code>dpreproc</code> script takes advantage of this to reduce memory usage.</li>
<li>Stage 2 of <code>dpreproc</code> will now only visualise <em>b</em>=0 volumes, rather than all data.</li>
<li>The brain mask generated in stage 3 of <code>dpreproc</code> is now displayed semitransparently for ease of evaluation.</li>
<li>The <code>dicomsort</code> script can now sort a directory by subject as well as series. It also handles missing identifiers better.</li>
<li>The option to threshold seed points on metrics other than anisotropy in the <code>track</code> and <code>rtrack</code> scripts is deprecated (meaning that it will still work, but a warning will be generated).</li>
<li>The <code>tensorfit</code> script now handles negative data values more gracefully. An sum of squared errors (SSE) image is now created irrespective of the fitting method used.</li>
<li>The <code>imageinfo</code> script can now be used with a directory of DICOM files as well as an Analyze/NIfTI/MGH image file.</li>
<li>The <code>gmap</code> script gains an option to create a colour bar.</li>
<li>The <code>plotcorrections</code> script now allows <code>Mode:all</code> and can be run noninteractively. (Requested by Mark Bastin.)</li>
<li>The &ldquo;fslview&rdquo; viewer is now run quietly to suppress spurious warnings.</li>
<li>TractoR now uses the &ldquo;quartz&rdquo; R device by default on Mac OS X systems. This should result in smoother on-screen graphics.</li>
<li>TractoR run in debug mode will now print stack traces for warnings as well as errors.</li>
</ul>

<h2 id="209-2012-03-02">2.0.9 (2012-03-02)</h2>

<ul>
<li>The <code>dicomsort</code> script now avoids copying files onto themselves.</li>
<li>The <code>tensorfit</code> script now handles negative data values more gracefully.</li>
<li>The <code>hnt-ref</code> test has been made a bit more robust (i.e. less likely to fail for spurious reasons).</li>
</ul>

<h2 id="208-2011-11-16">2.0.8 (2011-11-16)</h2>

<ul>
<li>Fixes to TractoR&#39;s handling of images stored using nondiagonal xforms (or the equivalent) have been made.</li>
<li>Thread-safe temporary files are now used more widely.</li>
</ul>

<h2 id="207-2011-11-10">2.0.7 (2011-11-10)</h2>

<ul>
<li>Somewhat cryptic errors about an &ldquo;incorrect number of dimensions&rdquo; should no longer appear when performing tractography. These occurred rarely, when a tract was extremely short.</li>
<li>An incompatibility between masks generated by <code>dpreproc</code> in its default mode and the internal tractography code has been corrected.</li>
<li>Running the <code>mtrack</code> script with one or more waypoint masks should no longer fail.</li>
</ul>

<h2 id="206-2011-10-24">2.0.6 (2011-10-24)</h2>

<ul>
<li>The <code>mean</code> and <code>gmean</code> scripts now handle &ldquo;NaN&rdquo; more sensibly, giving useful output even when they occur.</li>
<li>A bug related to reading Analyze-format image files has been fixed.</li>
<li>The &ldquo;reportr&rdquo; R package has been upgraded to version 1.0.0.</li>
<li>References to the <a href="http://www.jstatsoft.org/v44/i08/">TractoR JSS paper</a> have been added in the package documentation.</li>
</ul>

<h2 id="205-2011-10-11">2.0.5 (2011-10-11)</h2>

<ul>
<li>An error about a missing &ldquo;dti_eigval1&rdquo; image should no longer appear when calling <code>mean</code> or <code>gmean</code> with <code>Metric:axialdiff</code> on data originally preprocessed with TractoR 1.x. (Reported by Mark Bastin.)</li>
<li>Errors about &ldquo;no loop to break from&rdquo; should no longer be generated by <code>pnt-viz</code> or <code>pnt-prune</code> when a data set with no match data is encountered. (Reported by Michael Yoong.)</li>
<li>The error &ldquo;object &#39;nullPosterior&#39; not found&rdquo; should no longer appear when calling <code>pnt-interpret</code> with <code>Mode:null-posterior</code>.</li>
</ul>

<h2 id="204-2011-10-07">2.0.4 (2011-10-07)</h2>

<ul>
<li>Further refinements for the upcoming R 2.14.0 have been made. All tests now pass on that platform.</li>
<li>The TractoR R packages are now byte-compiled on versions of R which support this (2.13.0 and later). This should provide a general speed-up that should be more substantial in R 2.14.0 and later, in which the core packages are also byte-compiled by default.</li>
<li>The voxel unit of an image is now correctly set to &ldquo;unknown&rdquo; where appropriate.</li>
<li>A bug, which could result in spurious &ldquo;image not found&rdquo; errors when working with tractography on datasets processed for two fibre populations per voxel, has now been fixed. (Reported by Mark Bastin.)</li>
</ul>

<h2 id="203-2011-09-23">2.0.3 (2011-09-23)</h2>

<ul>
<li>The <code>gradcheck</code> script gains an option to allow the user to circumvent use of the internal image viewer.</li>
<li>The &ldquo;objects&rdquo; subdirectory of a session is now deleted when updating the hierarchy to TractoR 2.x format. This avoids errors of the form &ldquo;X is not a defined class&rdquo; which were previously occurring due to the lack of forward-compability between stored objects in TractoR 1.x and 2.x.</li>
<li>The <code>FlipGradientAxes</code> option to <code>dpreproc</code> now expects comma-separated axis letters, rather than unseparated numbers, for consistency with <code>gradcheck</code>.</li>
<li>The wrapper function for FSL <code>probtrackx</code> has been made more &ldquo;thread-safe&rdquo;, making parallelised code which uses it (such as <code>pnt-data</code> with <code>Tracker:fsl</code>) more reliable.</li>
<li>The session status report test has been updated and should no longer fail.</li>
<li>R packages are now installed more cleanly, leaving fewer intermediate files lying around.</li>
<li>Various corrections have been made to script descriptions.</li>
<li>Several other R-level tweaks and fixes have also been made, including some changes to the semantics of indexing and replacement for <code>MriImage</code> objects.</li>
<li>Support for changes upcoming in R 2.14.0 (expected 31 October 2011) has been added.</li>
</ul>

<h2 id="202-2011-08-10">2.0.2 (2011-08-10)</h2>

<ul>
<li>The third and fourth stages of the <code>dpreproc</code> script have been swapped around. This was the intended order for version 2.0.x.</li>
<li>A test image file has been renamed for consistency with other similar files.</li>
</ul>

<h2 id="201-2011-08-05">2.0.1 (2011-08-05)</h2>

<ul>
<li>This is a major new release with many significant changes. The main intention has been to broaden the scope of the package and make it more flexible, laying the foundations for future development. The package&#39;s dependence on FSL has also been lessened substantially. It is not fully backwards compatible with TractoR 1.x, so it is recommended that the two not be mixed within a single study.</li>
<li>TractoR&#39;s internals have changed substantially, and make use of features relatively recently added to R. Therefore, R 2.12.1 (released December 2010) or later is required to install TractoR 2.0.</li>
<li>The session hierarchy has been revamped. The primary directory for diffusion-weighted data is now called &ldquo;diffusion&rdquo;, although an &ldquo;fdt&rdquo; directory will still be created for interoperability with FSL if needed. The image file names within the &ldquo;diffusion&rdquo; directory are also different by default, although greater flexibility on these names is now available through so-called &ldquo;session maps&rdquo;. TractoR 2.0 will automatically update a session hierarchy created with TractoR 1.x when it first encounters it, but the image file names in the new &ldquo;diffusion&rdquo; (old &ldquo;fdt&rdquo;) directory will be left alone, and a map file will be created to allow TractoR 2.0 find what it needs. NB: Using TractoR 1.x with a session directory updated in this way is not guaranteed to work correctly, and is not recommended.</li>
<li>Two scripts have been renamed in light of the broader scope of the new version: <code>mkbvecs</code> is now called <code>gradread</code>; and <code>preproc</code> is now called <code>dpreproc</code>, since it is specific to diffusion-weighted data.</li>
<li>The functionality of the former <code>preproc</code> script (now <code>dpreproc</code>) has been split up for flexibility, and to avoid confusion. It now only handles functions which are truly preprocessing operations, so diffusion tensor fitting is now performed by the new <code>tensorfit</code> script, gradient direction checking (and flipping if necessary) by <code>gradcheck</code>, gradient rotation by <code>gradrotate</code>, and FSL-BEDPOSTX by <code>bedpost</code>. Run &ldquo;tractor -o tensorfit&rdquo;, and so on, to see the options for these new scripts. DICOM to NIfTI conversion, eddy current distortion correction and brain extraction remain in <code>dpreproc</code>, and it now has four stages rather than five. The progress of that pipeline can be shown using the StatusOnly option.</li>
<li>Some script options have new defaults, in line with current best practices, or to use TractoR-internal functionality where possible. For example, MaskingMethod in <code>dpreproc</code> now defaults to &ldquo;kmeans&rdquo;, while BetIntensityThreshold defaults to 0.3 because experience has suggested that this value produces more successful results.</li>
<li>The default value of any option in any script can now be overridden on a per-user basis by creating a config file corresponding to the script in ~/.tractor, and setting the default value there. For example, <code>dpreproc</code> will use FSL-BET for brain masking (as in TractoR 1.x) if you put the text &ldquo;MaskingMethod: bet&rdquo; into the file ~/.tractor/dpreproc.yaml. See the man page for details.</li>
<li>TractoR can now read and write the MGH image file format used by the <a href="http://surfer.nmr.mgh.harvard.edu/">FreeSurfer</a> package. These files have extension &ldquo;.mgh&rdquo; (uncompressed) or &ldquo;.mgz&rdquo; (compressed).</li>
<li>An iterative weighted least-squares fitting process for diffusion tensors is now available through the <code>tensorfit</code> script.</li>
<li>The <code>dicomsort</code> script now stops reading each file once the series number is encountered, producing a typical speedup of around 25%. Directory names created by this script now include leading zeroes to ensure that they are always displayed in the right order.</li>
<li>The <code>platform</code> script now additionally prints the TractoR home directory.</li>
<li>The <code>view</code> script now allows multiple files to be specified.</li>
<li>The default verbosity level is now 1, rather than 0. Users may therefore see much more output than before. The default can be switched back by setting up ~/.tractor/config appropriately: see the man page for details.</li>
<li>A warning is now raised if series descriptions are not consistent when reading a DICOM directory.</li>
<li>The &ldquo;-r&rdquo; flag to the main <code>tractor</code> program is deprecated.</li>
<li>The package installation process is now less verbose.</li>
<li>Many R-level changes and enhancements have been made, including tweaks to support changes upcoming in R 2.14.0, due in October.</li>
</ul>

<h2 id="183-2012-08-29">1.8.3 (2012-08-29)</h2>

<ul>
<li>The <code>pnt-prune</code> script would sometimes misinterpret the median streamline which is used as a baseline, resulting in a far less tightly pruned final tract than expected for some data sets. This has now been corrected. (Back-ported from version 2.2.1.)</li>
<li>A number of improvements have been made relating to TractoR&#39;s handling of very short tracts. (Partly back-ported from version 2.0.7.)</li>
</ul>

<h2 id="182-2011-10-20">1.8.2 (2011-10-20)</h2>

<ul>
<li>A number of fixes have been back-ported from TractoR 2.x, specifically relating to compatibility with R 2.14.0 and thread safety.</li>
<li>Citations to the TractoR JSS paper have been added.</li>
<li>A bug causing problems when reading 2D NIfTI files has been corrected.</li>
</ul>

<h2 id="181-2011-06-24">1.8.1 (2011-06-24)</h2>

<ul>
<li>A spurious warning was previously produced when reading a NIfTI file with more than 3 dimensions. This has been fixed.</li>
<li>The simple &ldquo;hello world&rdquo; test should no longer fail on some platforms due to whitespace differences.</li>
<li>The <code>platform</code> script now always displays its output, irrespective of the verbosity level set.</li>
</ul>

<h2 id="180-2011-05-25">1.8.0 (2011-05-25)</h2>

<ul>
<li>The NIfTI file reading code in TractoR is now substantially more flexible, and supports images stored using conventions other than the LAS arrangement which is used internally.</li>
<li>Read support for the proposed new <a href="http://www.nitrc.org/forum/forum.php?thread_id=2148&amp;forum_id=1941">NIfTI-2 file format</a> has been added.</li>
<li>Image origins are now adjusted appropriately when image data are flipped on reading, and negative and noninteger values are allowed for. The result of the <code>imageinfo</code> script may therefore differ from previous versions for some files, but the new output is more consistent with TractoR&#39;s conventions.</li>
<li>Any gradient flip specified with the FlipGradientAxes option is now performed during stage 2 of the <code>preproc</code> script, to avoid problems with doing it after rotating the directions.</li>
</ul>

<h2 id="171-2011-02-07">1.7.1 (2011-02-07)</h2>

<ul>
<li>When installing the &ldquo;tractor.native&rdquo; package, a greater effort is now made to find &ldquo;zlib&rdquo; on the user&#39;s system. If it is not available, the package is compiled without support for reading gzipped NIfTI files. Previously the compilation would simply fail. (Reported by Mark Bastin.)</li>
</ul>

<h2 id="170-2010-12-20">1.7.0 (2010-12-20)</h2>

<ul>
<li>TractoR now contains its own tractography algorithm, provided in the new &ldquo;tractor.native&rdquo; R package. The bulk of the tracker is written in C for speed, so this package requires compilation. Use of this tracker is optional and currently only supported in scripts which use one seed point at a time (i.e. <code>track</code>, <code>pnt-data</code>, <code>pnt-data-sge</code>, <code>pnt-ref</code> and <code>pnt-prune</code>). However, the speed gains can be considerable: in testing, <code>track</code> ran up to 30% faster using the TractoR tracker, and <code>pnt-data</code> ran 50-70% faster. Results from the FSL and TractoR trackers should be similar but will not be identical, so it may be wise not to mix the two within studies. FSL remains the default for now.</li>
<li>The main <code>tractor</code> program now supports a &ldquo;-a&rdquo; flag, which can be used to select between subarchitectures on R platforms that support them, such as Mac OS X. This allows users to select between, for example, 32-bit and 64-bit versions of R for running TractoR scripts.</li>
<li>In TractoR version 1.5.0 and later, <code>pnt-data</code> no longer collated its output into a single file. This was unintentional and has now been corrected: collation will now happen automatically unless the SessionNumbers option is used to select a subgroup of sessions to process. (Reported by Ping-Hong Yeh.)</li>
<li>The full data set image for the example session used by TractoR&#39;s self-tests is now included in the distribution.</li>
</ul>

<h2 id="160-2010-10-22">1.6.0 (2010-10-22)</h2>

<ul>
<li>The <code>preproc</code> script now offers two alternatives to BET for masking in the region for further processing. These are selected using the new MaskingMethod option. The &ldquo;kmeans&rdquo; option will apply k-means clustering, which is faster than BET and requires no parameters to be set, but will usually leave some non-brain voxels within the mask. The &ldquo;fill&rdquo; option will simply mask in the whole image region, and therefore all voxels will undergo all subsequent processing. These alternatives are particularly useful to simplify the preprocessing, or when FSL is not available, or when processing non-brain data.</li>
<li>MNI standard space images representing the brain and regions of grey matter, white matter and CSF have been added to the distribution in the <code>share/mni</code> directory. TractoR therefore no longer relies on versions of these images supplied with FSL. We are grateful to the International Consortium for Brain Mapping (ICBM) for making these available.</li>
<li>New scripts have been added for cloning session hierarchies (<code>clone</code>), extracting the voxel values of an image within a mask (<code>values</code>), and viewing an image in <code>fslview</code> in a way that avoids an incompatibility between that viewer and certain NIfTI data types (<code>view</code>).</li>
<li>Mask-based tractography (using the <code>mtrack</code> script) now reports the number of nonzero voxels in the mask, and the number of streamlines retained after applying waypoint masks. (This output is produced at the &ldquo;info&rdquo; level, so <code>-v1</code> must be given to <code>tractor</code> to see it.)</li>
<li>The <code>dicomsort</code> script will now handle data sets with duplicate file names within a series. In addition, this script&#39;s functionality is now available at the R level.</li>
<li>The <code>dicomtags</code> script will now look in subdirectories for a DICOM file if its argument is a directory, rather than just in the directory itself.</li>
<li>Tests that fail will now be rerun, rather than skipped, if <code>make test</code> is run again from the main TractoR directory.</li>
<li>The way that diffusion encoding schemes are handled within the core code of TractoR has been changed to improve consistency and portability. However, this change should not have any effect for those using only the <code>tractor</code> program to perform standard tasks.</li>
<li>2D images written out to NIfTI files now have their &ldquo;sform&rdquo; and &ldquo;qform&rdquo; codes set to zero, since TractoR does not keep track of their orientations.</li>
<li>An adjustment has been made to avoid problems with the gradient rotation part of the <code>preproc</code> script, which in some circumstances could try to read the brain-extracted b=0 image before it had been created.</li>
<li>The <code>xfmconvert</code> script is now defunct and has been removed. The new transformation storage format has been in place since TractoR 1.0.</li>
<li>A few other minor improvements and fixes have been implemented.</li>
</ul>

<h2 id="150-2010-06-29">1.5.0 (2010-06-29)</h2>

<ul>
<li>TractoR now offers a simple method for parallelising code, which uses the <a href="http://www.rforge.net/multicore/">&ldquo;multicore&rdquo; package</a> for R by Simon Urbanek. Users can now take advantage of multicore systems by simply specifying the &ldquo;-p&rdquo; option (with a parallelisation factor) to the main &ldquo;tractor&rdquo; program. The man page has more details. This option is only supported by certain scripts: at present these are <code>hnt-eval</code>, <code>hnt-viz</code>, <code>pnt-data</code>, <code>pnt-viz</code> and <code>pnt-prune</code>.</li>
<li>In addition to lightweight multicore parallelisation, there is now a version of the <code>pnt-data</code> script which supports parallelisation on a grid using the Sun Grid Engine (SGE). This version of the script is called <code>pnt-data-sge</code>, and can be used like <code>pnt-data</code>, with a few extra options specific to SGE. Another supporting script, <code>pnt-collate</code> has also been added.</li>
<li>A new script, <code>dirviz</code>, can be used to visualise principal fibre orientations within each voxel of a data set.</li>
<li>The new <code>platform</code> script reports various details of the software platform that TractoR is being run on.</li>
<li>The <code>plotrotations</code> script has been replaced by the more general <code>plotcorrections</code>, which can display rotation angles, translations, scales or skews.</li>
<li>The text files produced by <code>pnt-data</code> now include the seed point associated with each row, for greater flexibility downstream. Scripts are still compatible with the old format however.</li>
<li>The DICOM reading code no longer immediately rejects non-MR images, although it has not been tested with CT or other data.</li>
<li>The <code>preproc</code> script now lets the user know when the gradient cache has been updated. It also gains an option to force this update.</li>
<li>An adjustment has been made to allow for some Siemens DICOM files which report zero image slices.</li>
<li>The <code>pnt-viz</code> script gains a NumberOfSamples option.</li>
<li>X11 libraries are no longer used to create images in the <code>pnt-viz</code> and <code>pnt-prune</code> scripts.</li>
<li>The R package &ldquo;tractor.base&rdquo; has now been split into &ldquo;tractor.base&rdquo; and &ldquo;tractor.utils&rdquo;.</li>
</ul>

<h2 id="144-2010-06-14">1.4.4 (2010-06-14)</h2>

<ul>
<li>Gradient caching code used by the <code>preproc</code> script will no longer fail if no &ldquo;.tractor&rdquo; directory exists in the user&#39;s home directory. The directory will now be created if it is missing.</li>
<li>The TractoR NIfTI file reader now accepts files with negative qform elements, as intended.</li>
</ul>

<h2 id="143-2010-05-28">1.4.3 (2010-05-28)</h2>

<ul>
<li>An incompatibility with FSL 4.1.5, due to a change in the behaviour of FSL <code>probtrackx</code>, has been corrected.</li>
<li>DICOM tests have been updated to work with the read code change introduced in TractoR version 1.4.2.</li>
<li>The &ldquo;tractor -o&rdquo; test is now a bit more robust.</li>
</ul>

<h2 id="142-2010-05-06">1.4.2 (2010-05-06)</h2>

<ul>
<li>An internal problem in some HNT reference tracts has been corrected, so spurious errors should no longer be generated when running <code>hnt-eval</code>.</li>
<li>An adjustment to the DICOM reading code has been made to avoid an incompatibility with the recently released R 2.11.0.</li>
</ul>

<h2 id="141-2010-03-31">1.4.1 (2010-03-31)</h2>

<ul>
<li>The &ldquo;avscale&rdquo; test previously failed on some Linux installations due to a slight platform dependence in the FSL program&#39;s output. This issue has been avoided in this release, so the tests should run successfully on these platforms.</li>
<li>Unneeded files which were accidentally included in the version 1.4.0 release (&ldquo;filter.R&rdquo; and the &ldquo;multicore&rdquo; directory) have been removed.</li>
</ul>

<h2 id="140-2010-03-11">1.4.0 (2010-03-11)</h2>

<ul>
<li>TractoR now supports B-matrix/gradient vector rotation to compensate for the motion/eddy current distortion correction applied. Just set the RotateGradients option to &ldquo;true&rdquo; for stage 2 of the <code>preproc</code> script. The new experiment script <code>plotrotations</code> can be used to get a set of how big the effect will be for a particular data set.</li>
<li>Gradient directions (before rotation) for diffusion MRI acquisitions are now cached in the user&#39;s ~/.tractor directory and automatically placed into a session directory if the series description matches and no gradient direction information is found in the DICOM files. This facility can save a lot of time manually copying bvals and bvecs files into session directories. Its use is determined by the UseGradientCache option to the <code>preproc</code> script.</li>
<li>Group mapping, in particular of tracts produced by <code>hnt-viz</code>, <code>pnt-viz</code> and <code>pnt-prune</code>, is now available through the new <code>gmap</code> script. A set of images are transferred into standard (MNI) space and overlaid to visualise spatial consistency. Run &ldquo;tractor -o gmap&rdquo; for options.</li>
<li>Contact sheet style visualisation is now available for Analyze/NIfTI volumes, wherein all slices of an image along a particular direction are shown in a grid. The new <code>contact</code> script is the interface to this functionality.</li>
<li>The new <code>age</code> script can be used to determine a subject&#39;s age to the day from a DICOM file.</li>
<li>The new <code>binarise</code> script can be used to binarise Analyze/NIfTI volumes, with an optional threshold.</li>
<li>Options such as RunStages in <code>preproc</code> and SessionNumbers in <code>pnt-prune</code> now allow number ranges (e.g. 1-10) as input, for convenience and conciseness.</li>
<li>The HowRunBedpost option in the <code>preproc</code> script now defaults to &ldquo;fg&rdquo; (running in the foreground). The use of &ldquo;screen&rdquo; was confusing for several users, but can be forced if required. The &ldquo;auto&rdquo; value is no longer used or supported.</li>
<li>The <code>pnt-ref</code> script gains a MaximumAngle option, to avoid sharp turns near the ends of the created reference tract.</li>
<li>The output file name in the <code>dicomread</code> script now defaults to the same as the name of the source directory.</li>
<li>The window limits (black and white points) for images produced by the <code>proj</code>, <code>slice</code>, <code>contact</code> and <code>gmap</code> scripts can now be set using the new WindowLimits option.</li>
<li>The <code>dicomsort</code> script now creates subdirectories containing the relevant series descriptions in their names, for greater clarity.</li>
<li>Various improvements have been made to DICOM reading code for Philips and Siemens files, and for images acquired obliquely.</li>
<li>The <code>rtrack</code> script unintentionally ignored the NumberOfSamples option. This has been corrected.</li>
<li>Various other minor enhancements.</li>
</ul>

<h2 id="130-2009-11-10">1.3.0 (2009-11-10)</h2>

<ul>
<li>Support for a new approach to rejecting false positive connections in probabilistic neighbourhood tractography has been added through the <code>pnt-prune</code> experiment script. This script can be run instead of <code>pnt-viz</code>, and uses the PNT modelling framework to substantially clean up tract segmentations. Details can be found on the <a href="PNTTutorial.html">PNT tutorial page</a>). Run &ldquo;tractor -o pnt-prune&rdquo; for options.</li>
<li>A set of tests have been added to the package, to ensure that installation went successfully and everything is working as expected. These can be run from the main TractoR directory with the command &ldquo;make test&rdquo;.</li>
<li>A specific PNT model can now be specified directly for the <code>pnt-eval</code> and <code>pnt-interpret</code> scripts, allowing substantially greater flexibility.</li>
<li>The <code>pnt-ref</code> and <code>hnt-eval</code> scripts now support a NumberOfSamples option, to set the number of streamlines used by the underlying tractography algorithm.</li>
<li>The <code>track</code> and <code>mtrack</code> scripts now have a CreateVolumes option, for consistency with other similar scripts. The behaviour of the <code>rtrack</code> script has also been brought into line with other related scripts.</li>
<li>The <code>chfiletype</code> script can now be used with multiple files.</li>
<li>The <code>tractor</code> program now supports a &ldquo;-i&rdquo; flag to suppress the user&#39;s default configuration file.</li>
<li>Running &ldquo;tractor -o (script)&rdquo; no longer requires <code>ruby</code>.</li>
<li>The DICOM reading code should no longer incorrectly identify non-Siemens images as mosaic volumes.</li>
<li>Duplicated stack traces were sometimes produced when <code>tractor</code> was run in debug mode. This has been corrected.</li>
<li>The <code>extract</code> script no longer fails when the CreateImages option is on and the OverlayOnBrain option is off.</li>
<li>Some minor adjustments to output messages have been made.</li>
</ul>

<h2 id="120-2009-08-21">1.2.0 (2009-08-21)</h2>

<ul>
<li>HNT and PNT reference tracts have been added for the corpus callosum splenium (forceps posterior), arcuate fasciculi, uncinate fasciculi and anterior thalamic radiations. (Credit to Dr Susana Muñoz Maniega.)</li>
<li>Significant performance improvements have been made to the DICOM reading code, decreasing read times by up to 50%. Users should find that performance is even better with R 2.9.2, which is planned for release on 2009-08-24.</li>
<li>A new mechanism is now behind &ldquo;tractor -o (script)&rdquo;, and as a result the program displays the available options for those configuration variables, like &ldquo;PointType&rdquo;, which can only take certain values. This change finally closes issue #2.</li>
<li>The <code>status</code> script defaults to the current directory if none is specified. It will also no longer create an empty camino subdirectory.</li>
<li>The <code>dicomtags</code> script now accepts a directory name instead of a file name, in which case it will look for a DICOM file in that directory and print the tags for that file. If nothing is specified, the current directory is used by default.</li>
<li>If an experiment script is not found, the <code>tractor</code> program now prints the name of the missing file.</li>
<li>Minor documentation changes.</li>
</ul>

<h2 id="110-2009-06-15">1.1.0 (2009-06-15)</h2>

<ul>
<li>The TractoR implementation of probabilistic neighbourhood tractography now supports &ldquo;asymmetric&rdquo; models, which have more degrees of freedom than normal symmetric models, but potentially fit the data better. Use of this option is now recommended in medium and large data sets.</li>
<li>The <code>caminofiles</code> script now creates <a href="http://web4.cs.ucl.ac.uk/research/medic/camino/pmwiki/pmwiki.php?n=Man.Camino#lbAE">version 2</a> Camino scheme files, and therefore there is no longer any need to specify a diffusion time. In addition, a spurious warning about an existing directory is no longer generated.</li>
<li>The <code>mean</code> and <code>gmean</code> scripts now accept the new values &ldquo;Lax&rdquo; and &ldquo;Lrad&rdquo; for axial and radial diffusivity, respectively. These are passed to the &ldquo;Metric&rdquo; option.</li>
<li>DICOM code now handles images whose slices are slightly oblique, with a warning. No reslicing is performed.</li>
<li>Error messages for missing and multiple image files are now different, to avoid confusion.</li>
<li>The FSLOUTPUTTYPE environment variable is no longer used to set the internal default file type for TractoR. If the TRACTOR_FILETYPE environment variable is not set, the file type defaults to NIFTI_GZ. (Given that TractoR now supports more file types than FSL, this synchronisation makes less sense than it used to.)</li>
<li>The data preprocessing script, <code>preproc</code>, no longer returns information about the state of the session. This information (and more) can be obtained using the new <code>status</code> script.</li>
<li>The <code>imageinfo</code> and <code>dicomtags</code> scripts now support filenames containing spaces (although these are generally <em>not</em> recommended).</li>
<li>All messages, including warnings, are now reported in the order that they are raised by the code.</li>
<li>The tractor.base R package is now fully documented at the R level.</li>
</ul>

<h2 id="101-2009-03-16">1.0.1 (2009-03-16)</h2>

<ul>
<li>The <code>dicomread</code> script now uses the FSLOUTPUTTYPE environment variable to decide on a file format to use if TRACTOR_FILETYPE is not set. This was always the intended behaviour.</li>
<li>Fixing an issue that would produce an error when reading a 2D NIfTI image file.</li>
<li>The <code>pnt-eval</code> script will now find standard reference tracts as intended.</li>
<li>The <code>caminofiles</code> script would previously always ask for confirmation, even if the camino directory didn&#39;t previously exist.</li>
</ul>

<h2 id="100-2009-02-13">1.0.0 (2009-02-13)</h2>

<ul>
<li>A set of standard reference tracts for five major pathways are now included with the TractoR distribution.</li>
<li>New neighbourhood tractography functionality has been added, for &ldquo;unsupervised&rdquo; tract segmentation (using the new <code>pnt-em</code> experiment) and extracting parameters of interest from NT results (<code>hnt-interpret</code> and <code>pnt-interpret</code>).</li>
<li>The new <code>list</code> experiment lists all available TractoR experiment scripts.</li>
<li>The new <code>dicomread</code> experiment has been added to convert any directory of DICOM files into an Analyze/NIfTI volume. DICOM read support is now more flexible, and can read images with nonaxial slices.</li>
<li>The format and name of the file which stores the transform from MNI space to each session&#39;s diffusion space (in the tractor/objects directory) has changed. As a result the registration will be repeated the first time it is needed. The new <code>xfmconvert</code> script can be used to convert existing files to the new format (<code>tractor -o xfmconvert</code> for usage information).</li>
<li>The <code>preproc</code> experiment now shows the principal directions of the diffusion tensor in FSLview during stage 4. It also interprets its DicomDirectory parameter as representing a full path if it begins with a &ldquo;/&rdquo; character.</li>
<li>The <code>chfiletype</code> experiment can now be used to change the datatype of an image as well as the file format.</li>
<li>Warning messages that occur multiple times are now generally shown only once &ndash; along with the number of occurrences. Warnings from R core code are also reported in this way.</li>
<li>Log files created with the &ldquo;-l&rdquo; flag are now named for the script that was run.</li>
<li>Some scripts handle missing data or files more gracefully.</li>
<li>The main <code>tractor</code> script now requires the <code>bash</code> shell specifically (not <code>sh</code>).</li>
</ul>

<h2 id="beta-31-2008-08-18">Beta 3.1 (2008-08-18)</h2>

<ul>
<li>A mistake in the <code>dicomsort</code> and <code>peek</code> experiment scripts meant that they produced errors about missing functions. This has been corrected.</li>
<li>Following the dropping of support for the Analyze file format by FSL 4.1, this beta provides some extra tools for those who wish to continue using the format. Specifically, the environment variable TRACTOR_FILETYPE can be set to ANALYZE if the user wishes TractoR to output Analyze files by default. (This is no longer a legal value for FSL&#39;s environment variable FSLOUTPUTTYPE, which was previously used for TractoR&#39;s default.) The <code>chfiletype</code> script has also been created for converting between formats as required: please run <code>tractor -o chfiletype</code> for details.</li>
</ul>

<h2 id="beta-30-2008-08-11">Beta 3.0 (2008-08-11)</h2>

<ul>
<li>The way in which TractoR looks for its scripts has changed somewhat. This should make installation both simpler and more flexible in most cases.</li>
<li>Three new utility scripts have been added. The <code>caminofiles</code> experiment converts a data set into file formats suitable for use with the Camino diffusion MRI toolkit; <code>mkbvecs</code> assists with the creation of valid &ldquo;bvals&rdquo; and &ldquo;bvecs&rdquo; files for use with FSL; and <code>dicomsort</code> sorts a directory of DICOM files into subdirectories by series number. The latter is useful for separating diffusion data from structural acquisitions.</li>
<li>The time-consuming <code>pnt-data</code> experiment script now writes partial output as it goes and supports resuming a partially completed run. This makes interruptions to this process, such as major errors or power loss, far less painful in terms of the time lost. The script also allows a single seed point to be specified on the command line with the new SeedPoint option.</li>
<li>The <code>preproc</code> experiment checks more robustly to make sure that its first stage has been completed properly. The script also more faithfully obeys its Interactive flag.</li>
<li>TractoR will now use R&#39;s batch mode if requested. This is not that useful under most usual circumstances, but can occasionally be helpful.</li>
<li>More minor tweaks and fixes.</li>
</ul>

<h2 id="beta-20-2008-04-29">Beta 2.0 (2008-04-29)</h2>

<ul>
<li>Entities which are stored in &ldquo;.Rdata&rdquo; files are now saved in a different way. This means that objects such as reference tracts created with beta 1.0 will not directly work with beta 2.0. However, this new arrangement should generally be forward-compatible with future releases. The new <code>peek</code> experiment script can be used to inspect these stored R objects.</li>
<li>The main <code>tractor</code> script has had some tweaks. The log file, &ldquo;tractor_output.log&rdquo; will now receive output from the experiment script in real time rather than all at the end. Multiple configuration files (specified with the &ldquo;-c&rdquo; flag) are now permitted, and paths to these files are now relative to the current working directory rather than the experiment&#39;s working directory (which was a bit counterintuitive). <code>tractor -o</code> now reports &ldquo;None&rdquo; if no options are available.</li>
<li>The user can set up default options for TractoR experiments using a ~/.tractor/config file. See the <code>tractor</code> man page for more details.</li>
<li>History log files (&ldquo;tractor_history.log&rdquo;) now include the date and time that the experiment script completed.</li>
<li>Added the <code>gmean</code> experiment script, a companion to <code>mean</code> aimed at applying the same calculation to a group of images. Run <code>tractor -o gmean</code> for details.</li>
<li>The interface of the <code>preproc</code> script has changed a little. It also supports a new option specifying a particular subdirectory to search for DICOM files.</li>
<li>The <code>mkroi</code> experiment no longer returns the names of the files it created.</li>
<li>The TractoR makefile now assumes that R is installed at /usr/local/bin/R by default.</li>
<li>An adjustment to the NIfTI file reading code has been made for compatibility with R 2.7.0.</li>
<li>Various minor changes and fixes.</li>
</ul>

<h2 id="beta-10-2008-03-03">Beta 1.0 (2008-03-03)</h2>

<ul>
<li>First public release.</li>
</ul>


</div>

</body>

</html>
